"use strict";var zaiquery={_attrs:{doms:{}},createApp:function(t,e){var n,r=t;for(n in this)this.hasOwnProperty(n)&&(r.hasOwnProperty(n)||(r[n]=this[n]));return r._attrs.doms.app=document.getElementById(e)||{},r.load(),r},fetch:function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&200===n.status&&e(JSON.parse(n.responseText))},n.open("GET",t,!0),n.send()},dom:function(t){window.requestAnimationFrame?window.requestAnimationFrame(t):t()},query:function(t){return this._attrs.doms.app.querySelectorAll(t)||[{}]}},autoComplete=zaiquery.createApp({attrs:{data:{},queryItems:[],dom:{}},templates:function(t,e){switch(t){case"suggestionItem":return'<li class="Lh-4 M-5"><button class="sug-item Bdr-r5 Bdr-3 Bgc-1">'+e+"</button></li>";case"queryItem":return'<li class="search-query D-ib P-3 Pl-5 Bgc-1 Bdr-r3 Bdr-4 Mr-3 Lh-2 anim-pop" data-query="'+e+'">'+e+'<button class="btn-x Ml-5 Bgc-0 Bdr-0 C-1" data-query="'+e+'">x</button></li>';default:return""}},getSuggestions:function(t){var e,n,r=t.length||0,u=autoComplete.attrs.data.tzdata[t.charAt(0)]||[],s=u.length||0,a=0,o=[],i=this.attrs.queryItems,m=i.length;for(e=0;s>e;e+=1)if(n=u[e],n.substr(0,r).toLowerCase()===t)a=1,o.push(n);else if(a)break;for(e=0;m>e;e+=1)o=this.returnArrayWithoutItem(i[e],o);return o},generateSuggestionsHtml:function(t){var e,n=autoComplete,r=n.getSuggestions(t),u=r.length,s=n.query(".suggestions")[0],a="";for(e=0;u>e;e+=1)a+=n.templates("suggestionItem",r[e]);n.dom(function(){s.innerHTML=a,n.bindSuggestionItemEvent()})},appendQueryItemHtml:function(t){var e=this;e.dom(function(){var n,r=e.query(".queries")[0];r.innerHTML+=e.templates("queryItem",t),n=e.query(".search-query:last-child")[0],setTimeout(function(){n.className=n.className.substring(0,n.className.indexOf("anim-pop"))},200),e.bindRemoveQueryEvent(n),e.setSuggestionBoxPos(),e.submitQuery()})},addQueryItem:function(t){var e=autoComplete,n=e.attrs.dom.input;-1===e.attrs.queryItems.indexOf(t)&&(e.attrs.queryItems.push(t),e.appendQueryItemHtml(t),n.focus()),e.dom(function(){n.value="",e.updateInputWidth(""),e.query(".suggestions")[0].innerText=""})},returnArrayWithoutItem:function(t,e){var n=e.indexOf(t),r=e.slice(0);return-1!==n&&r.splice(n,1),r},bindRemoveQueryEvent:function(){var t,e=autoComplete,n=e.query(".search-query .btn-x"),r=n.length,u=function(t){t.addEventListener("click",function(t){var n=t.target.dataset.query;e.attrs.queryItems=e.returnArrayWithoutItem(n,e.attrs.queryItems),this.parentNode.remove(),e.setSuggestionBoxPos(),e.submitQuery()})};for(t=0;r>t;t+=1)u(n[t])},bindSuggestionItemEvent:function(){var t=autoComplete;t.dom(function(){var e,n=t.query(".sug-item"),r=n.length,u=function(e){e.addEventListener("click",function(){t.addQueryItem(this.innerText)})};for(e=0;r>e;e+=1)u(n[e])})},updateInputWidth:function(t){var e=autoComplete,n=t.length,r=Math.max(50,10*n);e.attrs.dom.input.style.width=r+"px"},bindAutoCompleteEvent:function(t){var e=this;t.addEventListener("keyup",function(t){var n=t.target.value.trim();13==t.keyCode?(0!==e.attrs.queryItems.length||""!==n)&&(""!==n&&e.addQueryItem(n),e.submitQuery()):""!==n?(e.generateSuggestionsHtml(n),e.updateInputWidth(n),e.query(".query-string")[0].innerText=""):e.query(".suggestions")[0].innerText=""})},setSuggestionBoxPos:function(){var t=autoComplete,e=t.attrs.dom.input,n=e.offsetLeft,r=t.query(".suggestions")[0];r.style.left=n-5+"px"},submitQuery:function(){var t,e=autoComplete,n=e.attrs.queryItems,r=n[0]||"",u=n.length,s="/search?q="+escape(r),a=e.query(".query-string")[0];for(t=1;u>t;t+=1)s+="&"+escape(n[t]);a.innerText=s},cacheDom:function(){this.attrs.dom.input=this.query(".ac-input")[0]},load:function(){var t=this;t.fetch("./data/timezone.json",function(e){t.attrs.data.tzdata=e}),t.cacheDom(),t.query(".search-wrap")[0].addEventListener("click",function(){t.attrs.dom.input.focus()}),t.bindAutoCompleteEvent(t.attrs.dom.input)}},"search");