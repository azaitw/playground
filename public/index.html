<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Exercise: Auto-Complete</title>
        <style>.NA{-webkit-appearance:none}.Pos-a{position:absolute}.Pos-r{position:relative}.Pos-f{position:fixed}.D-b{display:block}.D-n{display:none}.D-i{display:inline}.D-ib{display:inline-block}.D-t{display:table}.D-tc{display:table-cell}.Op-0{opacity:0}.Op-1{opacity:1}.V-v{visibility:visible}.V-h{visibility:hidden}.Ov-h{overflow:hidden}.F-l{float:left}.F-r{float:right}.W-100{width:100%}.W-90{width:90%}.W-80{width:80%}.W-70{width:70%}.W-60{width:60%}.W-50{width:50%}.W-40{width:40%}.W-30{width:30%}.W-20{width:20%}.W-10{width:10%}.Mw-100{max-width:100%}.W-a{width:auto}.H-100{height:100%}.Mh-100{max-height:100%}.H-a{height:auto}.M-0a{margin:0 auto}.M-0{margin:0}.M-1{margin:1px}.M-3{margin:3px}.M-5{margin:5px}.M-7{margin:7px}.M-10{margin:10px}.M-15{margin:15px}.M-20{margin:20px}.M-30{margin:30px}.Mt-1{margin-top:1px}.Mt-3{margin-top:3px}.Mt-5{margin-top:5px}.Mt-7{margin-top:7px}.Mt-10{margin-top:10px}.Mt-15{margin-top:15px}.Mt-20{margin-top:20px}.Mt-30{margin-top:30px}.Ml-1{margin-left:1px}.Ml-3{margin-left:3px}.Ml-5{margin-left:5px}.Ml-7{margin-left:7px}.Ml-10{margin-left:10px}.Ml-15{margin-left:15px}.Ml-20{margin-left:20px}.Ml-30{margin-left:30px}.Mb-1{margin-bottom:1px}.Mb-3{margin-bottom:3px}.Mb-5{margin-bottom:5px}.Mb-7{margin-bottom:7px}.Mb-10{margin-bottom:10px}.Mb-15{margin-bottom:15px}.Mb-20{margin-bottom:20px}.Mb-30{margin-bottom:30px}.Mr-1{margin-right:1px}.Mr-3{margin-right:3px}.Mr-5{margin-right:5px}.Mr-7{margin-right:7px}.Mr-10{margin-right:10px}.Mr-15{margin-right:15px}.Mr-20{margin-right:20px}.Mr-30{margin-right:30px}.P-0{padding:0}.P-1{padding:1px}.P-3{padding:3px}.P-5{padding:5px}.P-7{padding:7px}.P-10{padding:10px}.P-15{padding:15px}.P-20,.P-30{padding:20px}.Pt-1{padding-top:1px}.Pt-3{padding-top:3px}.Pt-5{padding-top:5px}.Pt-7{padding-top:7px}.Pt-10{padding-top:10px}.Pt-15{padding-top:15px}.Pt-20{padding-top:20px}.Pt-30{padding-top:30px}.Pl-1{padding-left:1px}.Pl-3{padding-left:3px}.Pl-5{padding-left:5px}.Pl-7{padding-left:7px}.Pl-10{padding-left:10px}.Pl-15{padding-left:15px}.Pl-20{padding-left:20px}.Pl-30{padding-left:30px}.Pb-1{padding-bottom:1px}.Pb-3{padding-bottom:3px}.Pb-5{padding-bottom:5px}.Pb-7{padding-bottom:7px}.Pb-10{padding-bottom:10px}.Pb-15{padding-bottom:15px}.Pb-20{padding-bottom:20px}.Pb-30{padding-bottom:30px}.Pr-1{padding-right:1px}.Pr-3{padding-right:3px}.Pr-5{padding-right:5px}.Pr-7{padding-right:7px}.Pr-10{padding-right:10px}.Pr-15{padding-right:15px}.Pr-20{padding-right:20px}.Pr-30{padding-right:30px}.Ta-c,table.Ta-c td,table.Ta-c th{text-align:center}.Td-0,.Td-0:hover,.Td-0:visited{text-decoration:none}.Td-1{text-decoration:overline}.Td-2{text-decoration:line-through}.Td-3{text-decoration:underline}.Va-t{vertical-align:top}.Va-m{vertical-align:middle}.Va-b{vertical-align:bottom}.T-0{top:0}.L-0{left:0}.R-0{right:0}.B-0{bottom:0}.Ta-l{text-align:left}.Ta-r{text-align:right}.Fz-0{font-size:9px}.Fz-1{font-size:11px}.Fz-2{font-size:13px}.Fz-3{font-size:15px}.Fz-4{font-size:17px}.Fz-5{font-size:20px}.Fz-6{font-size:24px}.Fw-1{font-weight:100}.Fw-2{font-weight:250}.Fw-3{font-weight:400}.Fw-4{font-weight:550}.Fw-5{font-weight:700}.Ff-ss{font-family:sans-serif}.Ff-s{font-family:serif}.Lh-1{line-height:13px}.Lh-2{line-height:15px}.Lh-3{line-height:17px}.Lh-4{line-height:20px}.Lh-5{line-height:25px}.Lh-6{line-height:30px}.Lh-7{line-height:35px}.Lh-8{line-height:40px}.Lh-9{line-height:45px}.Lh-10{line-height:50px}.Ls-1{letter-spacing:.1px}.Ls-2{letter-spacing:.3px}.Ls-3{letter-spacing:.5px}.Ls-4{letter-spacing:.7px}.Ls-5{letter-spacing:1px}.Ls-6{letter-spacing:3px}.Ws-nw{white-space:nowrap}.Bg-n{background:0 0}.Bdr-r1{border-radius:1px}.Bdr-r3{border-radius:3px}.Bdr-r5{border-radius:5px}.Z-0{z-index:0}.Z-1{z-index:1}.Z-2{z-index:10}.Z-3{z-index:100}.Z-4{z-index:1000}.Z-5{z-index:10000}.Cf:after,.Cf:before{content:" ";display:table}.Cf:after{clear:both}.noTxt{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px)}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background:0 0}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0;-ms-interpolation-mode:bicubic}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0;text-align:left}ul{margin:0;padding:0;list-style:none}html{font-family:Helvetica}input[type=text]:focus,textarea:focus{outline:0}.C-1{color:#83baeb}.Bgc-0{background:0 0}.Bgc-1{background:#B6D1FF}.Bgc-2{background:#ccc}.Bgc-3{background:#fff}.Bgc-4{background:#eee}.Bdr-0{border:0}.Bdr-1{border:1px solid #eee}.Bdr-2{border:1px solid #ccc}.Bdr-3{border:1px dashed #84A1FF}.Bdr-3:hover{background:#84A1FF}.Bdr-4{border:1px solid #84A1FF}.suggestions:before{display:block;content:" ";position:absolute;top:-5px;left:5px;width:0;height:0;border-bottom:5px solid #eee;border-left:5px solid transparent;border-right:5px solid transparent}@-webkit-keyframes webkit-pop{0%{-webkit-transform:scale(1)}50%{-webkit-transform:scale(1.5)}100%{-webkit-transform:scale(1)}}@keyframes pop{0%{transform:scale(1)}50%{transform:scale(1.5)}100%{transform:scale(1)}}.anim-pop{-webkit-animation:webkit-pop .2s;-moz-animation:webkit-pop .2s;animation-duration:.2s;animation-name:pop}</style></link>
    </head>
    <body class="Bgc-2">
        <div id="search" class="W-60 M-0a Mt-30 P-30 Bgc-3 Bdr-r5" style="min-width: 300px">
            <h1 class="Fz-5 Fw-1 Ta-c">Auto-Complete Search</h1>
            <div class="Mb-30 Bgc-4 Fz-2 Fw-1 Lh-6 P-3 Bdr-r5">
                <label>Query:</label>
                <div class="D-ib query-string"></div>
            </div>
            <div class="search-wrap Ls-3 Fw-1 Bdr-2 Pos-r M-0a Ta-l Pl-5 Pb-1 Cf Lh-6" style="cursor: text;">
                <ul class="queries D-i"></ul>
                <input type="text" class="D-ib ac-input H-100 P-0 Bdr-0 Lh-6" style="width:50px"/>
            </div>
            <div class="Mt-10 Pos-r"><ul class="suggestions Pos-r D-ib Bgc-4 Bdr-r5 Fw-1"></ul></div>
        </div>
    </body>
    <script>"use strict";var zaiquery={_attrs:{doms:{}},createApp:function(t,e){var n,r=t;for(n in this)this.hasOwnProperty(n)&&(r.hasOwnProperty(n)||(r[n]=this[n]));return r._attrs.doms.app=document.getElementById(e)||{},r.load(),r},fetch:function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&200===n.status&&e(JSON.parse(n.responseText))},n.open("GET",t,!0),n.send()},dom:function(t){window.requestAnimationFrame?window.requestAnimationFrame(t):t()},query:function(t){return this._attrs.doms.app.querySelectorAll(t)||[{}]}},autoComplete=zaiquery.createApp({attrs:{data:{},queryItems:[],dom:{}},templates:function(t,e){switch(t){case"suggestionItem":return'<li class="Lh-4 M-5"><button class="sug-item Bdr-r5 Bdr-3 Bgc-1">'+e+"</button></li>";case"queryItem":return'<li class="search-query D-ib P-3 Pl-5 Bgc-1 Bdr-r3 Bdr-4 Mr-3 Lh-2 anim-pop" data-query="'+e+'">'+e+'<button class="btn-x Ml-5 Bgc-0 Bdr-0 C-1" data-query="'+e+'">x</button></li>';default:return""}},getSuggestions:function(t){var e,n,r=t.length||0,u=autoComplete.attrs.data.tzdata[t.charAt(0)]||[],s=u.length||0,a=0,o=[],i=this.attrs.queryItems,m=i.length;for(e=0;s>e;e+=1)if(n=u[e],n.substr(0,r).toLowerCase()===t)a=1,o.push(n);else if(a)break;for(e=0;m>e;e+=1)o=this.returnArrayWithoutItem(i[e],o);return o},generateSuggestionsHtml:function(t){var e,n=autoComplete,r=n.getSuggestions(t),u=r.length,s=n.query(".suggestions")[0],a="";for(e=0;u>e;e+=1)a+=n.templates("suggestionItem",r[e]);n.dom(function(){s.innerHTML=a,n.bindSuggestionItemEvent()})},appendQueryItemHtml:function(t){var e=this;e.dom(function(){var n,r=e.query(".queries")[0];r.innerHTML+=e.templates("queryItem",t),n=e.query(".search-query:last-child")[0],setTimeout(function(){n.className=n.className.substring(0,n.className.indexOf("anim-pop"))},200),e.bindRemoveQueryEvent(n),e.setSuggestionBoxPos(),e.submitQuery()})},addQueryItem:function(t){var e=autoComplete,n=e.attrs.dom.input;-1===e.attrs.queryItems.indexOf(t)&&(e.attrs.queryItems.push(t),e.appendQueryItemHtml(t),n.focus()),e.dom(function(){n.value="",e.updateInputWidth(""),e.query(".suggestions")[0].innerText=""})},returnArrayWithoutItem:function(t,e){var n=e.indexOf(t),r=e.slice(0);return-1!==n&&r.splice(n,1),r},bindRemoveQueryEvent:function(){var t,e=autoComplete,n=e.query(".search-query .btn-x"),r=n.length,u=function(t){t.addEventListener("click",function(t){var n=t.target.dataset.query;e.attrs.queryItems=e.returnArrayWithoutItem(n,e.attrs.queryItems),this.parentNode.remove(),e.setSuggestionBoxPos(),e.submitQuery()})};for(t=0;r>t;t+=1)u(n[t])},bindSuggestionItemEvent:function(){var t=autoComplete;t.dom(function(){var e,n=t.query(".sug-item"),r=n.length,u=function(e){e.addEventListener("click",function(){t.addQueryItem(this.innerText)})};for(e=0;r>e;e+=1)u(n[e])})},updateInputWidth:function(t){var e=autoComplete,n=t.length,r=Math.max(50,10*n);e.attrs.dom.input.style.width=r+"px"},bindAutoCompleteEvent:function(t){var e=this;t.addEventListener("keyup",function(t){var n=t.target.value.trim();13==t.keyCode?(0!==e.attrs.queryItems.length||""!==n)&&(""!==n&&e.addQueryItem(n),e.submitQuery()):""!==n?(e.generateSuggestionsHtml(n),e.updateInputWidth(n),e.query(".query-string")[0].innerText=""):e.query(".suggestions")[0].innerText=""})},setSuggestionBoxPos:function(){var t=autoComplete,e=t.attrs.dom.input,n=e.offsetLeft,r=t.query(".suggestions")[0];r.style.left=n-5+"px"},submitQuery:function(){var t,e=autoComplete,n=e.attrs.queryItems,r=n[0]||"",u=n.length,s="/search?q="+escape(r),a=e.query(".query-string")[0];for(t=1;u>t;t+=1)s+="&"+escape(n[t]);a.innerText=s},cacheDom:function(){this.attrs.dom.input=this.query(".ac-input")[0]},load:function(){var t=this;t.fetch("./data/timezone.json",function(e){t.attrs.data.tzdata=e}),t.cacheDom(),t.query(".search-wrap")[0].addEventListener("click",function(){t.attrs.dom.input.focus()}),t.bindAutoCompleteEvent(t.attrs.dom.input)}},"search");</script>
</html>